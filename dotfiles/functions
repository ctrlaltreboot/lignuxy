## source me to add additional functionality to your shell

# mp423
# sometimes i download mp4s and i want them reduced by 1.
mp423() {
  VIDEO=$1
  AUDIO=$(basename $VIDEO)

  if [[ -f $VIDEO && -s $VIDEO ]]; then
    ffmpeg -i $VIDEO -b:a 192K -vn $AUDIO.mp3
  else
    echo 'A need for mp4 file as input has arised.'
  fi
}

curlcode() {
    local URL=$1
    curl -s -o /dev/null -w "%{http_code}" "${URL}"
}

# spacecape, replaces invisible spaces with visible the escaped character equivalent '\n'
# I use this mostly for making json compatible strings, so the filename output is in json.
spacecape() {
  SPACED_FILE=$1
  SPACED_JSON=${SPACED_FILE}.json

  if [[ -f ${SPACED_FILE} ]]; then
    cat ${SPACED_FILE} | sed s/$/\\\\n/ | tr -d '\n' > ${SPACED_JSON}
    echo "Want space? You got space! Happy times!"
    exit 0
  else
    echo "I need a file to make me happy"
    exit 1
  fi
}

ipmireset() {
  NODE=${1?"Error: Missing host/node address"}
  ipmitool -H $NODE -U haha -P hoho chassis power reset
}

ipmisol() {
  NODE=${1?"Error: Missing host/node address"}
  ipmitool -H $NODE -I lanplus -U haha -P hoho sol activate
}

freakthenetops() {
  for NODE in `cat $HOME/nodes.txt`; do
    # never uncomment
    # ipmitool -H $NODE -U haha -p hoho chassis identify 1
    echo $NODE
  done
}

copytv() {
  SRC=$1
  scp $SRC osmc:/mnt/GlipGlops/tv/
}

copymovies() {
  SRC=$1
  scp $SRC osmc:/mnt/GlipGlops/movies/
}

yaourt-install() {
    local package=$1
    if pacman -Qi yaourt &> /dev/null; then
        echo "Installing with yaourt"
        yaourt -S --noconfirm $package
    fi
}

screenshot() {
  scrot "$HOME/Pictures/screenshot-$(date +%F-%T).jpg"
}

windowscreenshot() {
  scrot -s "$HOME/Pictures/window-screenshot-$(date +%F-%T).jpg"
}

up() {
  local SRV=${1?"What goes up?"}
  sudo systemctl start $SRV.service
}

down() {
  local SRV=${1?"What goes down?"}
  sudo systemctl stop $SRV.service
}

cycle() {
  local SRV=${1?"What goes up and down?"}
  sudo systemctl restart $SRV.service
}
